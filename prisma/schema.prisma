generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Upload {
  id           String   @id @default(uuid()) @db.Uuid
  filename     String
  originalName String?
  rowsCount    Int      @default(0)
  createdAt    DateTime @default(now())

  @@map("Upload")
}

model Lead {
  id              String   @id @default(uuid()) @db.Uuid
  phoneRaw        String?
  phoneNormalized String   @unique
  fullName        String?
  position        String?
  rank            String?
  unit            String?
  notes           String?
  uploadId        String?  @db.Uuid
  createdAt       DateTime @default(now())
  updatedAt       DateTime @default(now())

  @@map("Lead")
}

model Call {
  id           String   @id @default(uuid()) @db.Uuid
  leadId       String?  @db.Uuid
  agentLabel   String?
  direction    String
  status       String
  durationSec  Int?
  startedAt    DateTime
  endedAt      DateTime?
  recordingUrl String?
  sipId        String?
  createdAt    DateTime @default(now())

  @@map("Call")
}

model LeadStats {
  id             String   @id @default(uuid()) @db.Uuid
  leadId         String   @unique @db.Uuid
  totalCalls     Int      @default(0)
  totalAnswered  Int      @default(0)
  lastCallAt     DateTime?
  lastAgentLabel String?

  @@map("LeadStats")
}

model SupportTicket {
  id        String   @id @default(uuid()) @db.Uuid
  subject   String
  body      String
  status    String   @default("open")
  createdAt DateTime @default(now())

  @@map("SupportTicket")
}
